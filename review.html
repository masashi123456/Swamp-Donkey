<!-- review.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reviews - SWAMP DONKEY</title>
    <meta name="author" content="David Lunceford, Masashi Ota, Ryan Griffin">
    <meta name="description" content="Customer reviews for Swamp Donkey Mobile Mechanic in Rexburg, ID.">
    <meta property="og:title" content="Swamp Donkey Reviews">
    <meta property="og:type" content="Web Page">
    <meta property="og:image" content="#">
    <meta property="og:url" content="https://github.com/masashi123456/Swamp-Donkey.git">

    <link rel="icon" href="images/favicon.ico">
    <!-- Consolidated site CSS: includes background, nav, typography, etc. -->
    <link rel="stylesheet" href="styles/consolidated.css">

    <!-- Tailwind CSS for review components -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for star icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <img id="logo" src="images/SWAMP DONKEY.png" alt="company logo">
    </header>

    <nav class="navbar">
        <a href="index.html">Home</a>
        <a href="quote.html">Quick Quote</a>
        <a href="services.html">Services</a>
        <a href="contact.html">Contact</a>
        <a href="review.html">Reviews</a>
    </nav>

    <main class="py-12 px-4 bg-site">
        <div class="max-w-4xl mx-auto space-y-12">
            <!-- Leave a Review Form -->
            <div class="review-form-card p-8">
                <h2 class="text-3xl font-bold text-center mb-6">Leave Us a Review</h2>
                <form id="reviewForm" class="space-y-6">
                    <div>
                        <label for="reviewerName" class="block font-medium">Your Name</label>
                        <input type="text" id="reviewerName" name="reviewerName" required
                               class="mt-1 w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:border-accent">
                    </div>
                    <div>
                        <label class="block font-medium text-center mb-2">Your Rating</label>
                        <div id="starRating" class="star-rating">
                            <input type="radio" id="star5" name="rating" value="5" required/><label for="star5"><i class="fas fa-star"></i></label>
                            <input type="radio" id="star4" name="rating" value="4"/><label for="star4"><i class="fas fa-star"></i></label>
                            <input type="radio" id="star3" name="rating" value="3"/><label for="star3"><i class="fas fa-star"></i></label>
                            <input type="radio" id="star2" name="rating" value="2"/><label for="star2"><i class="fas fa-star"></i></label>
                            <input type="radio" id="star1" name="rating" value="1"/><label for="star1"><i class="fas fa-star"></i></label>
                        </div>
                    </div>
                    <div>
                        <label for="reviewMessage" class="block font-medium">Review</label>
                        <textarea id="reviewMessage" name="reviewMessage" rows="4" required
                                  class="mt-1 w-full px-3 py-2 border rounded-md shadow-sm focus:ring focus:border-accent"></textarea>
                    </div>
                    <div class="text-center">
                        <button type="submit" class="submit-button font-bold py-3 px-8 rounded-lg shadow-lg">
                            Submit Review
                        </button>
                    </div>
                </form>
                <div id="confirmation-message" class="mt-6 text-center text-green-600 opacity-0 transform translate-y-2">
                    <p>Thank you! Your review has been submitted.</p>
                </div>
            </div>

            <!-- Display Reviews -->
            <div class="space-y-8">
                <h2 class="text-3xl font-bold text-center">What Our Customers Are Saying</h2>
                <div id="reviewsContainer" class="space-y-6">
                    <!-- User reviews loaded here -->
                </div>

                <!-- Google Reviews Placeholder -->
                <div class="google-reviews-section">
                    <h3 class="text-2xl font-bold text-center mb-6 flex items-center justify-center gap-3">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg"
                             alt="Google" class="h-6 w-6">
                        Google Reviews
                    </h3>
                    <div class="space-y-6">
                        <!-- Example Google Review Card -->
                        <div class="review-card p-6">
                            <div class="flex items-center mb-2">
                                <p class="font-bold">Jane Doe</p>
                                <div class="ml-auto flex items-center">
                                    <span class="text-amber-500">
                                        <i class="fas fa-star"></i><i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i><i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </span>
                                </div>
                            </div>
                            <p>"Incredible service! They came right to my workplace and fixed my car's issue in under an hour. Highly recommend!"</p>
                        </div>
                        <div class="review-card p-6">
                            <div class="flex items-center mb-2">
                                <p class="font-bold">John Smith</p>
                                <div class="ml-auto flex items-center">
                                    <span class="text-amber-500">
                                        <i class="fas fa-star"></i><i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i><i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </span>
                                </div>
                            </div>
                            <p>"Honest, fair pricing, and incredibly skilled. They were a lifesaver when I was stranded."</p>
                        </div>
                    </div>
                    <div class="mt-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <h4 class="font-bold text-blue-800">Note for the Business Owner:</h4>
                        <p class="text-sm text-blue-700">
                            To display live Google Reviews, use the Google Places API with your API Key and Place ID.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="foot">
            <p>üìû +1 208-547-8375</p>
            <p>üìß <a href="mailto:swampdonkeymobilemechanics@gmail.com">swampdonkeymobilemechanics@gmail.com</a></p>
            <p>üó∫Ô∏è
                <a
                href="https://www.google.com/maps/search/?api=1&query=235+S+4th+W+Rexburg%2C+ID+83440"
                target="_blank"
                rel="noopener"
                >
                235 S 4th W Rexburg, ID 83440
                </a>
            </p>
        <p id="lastModified"></p>
        </div>
        <div class="media">
            <a id="facebook" href="https://www.facebook.com/share/15zKQCcY5z/?mibextid=wwXIfr" target="_blank" rel="noopener" loading="lazy">
                <img src="images/fa.png" alt="facebook">
            </a>
            <a id="instagram" href="https://www.instagram.com/" target="_blank" rel="noopener" loading="lazy">
                <img src="images/insta.webp" alt="instagram">
            </a>
            <a id="x" href="https://x.com/?lang=en" target="_blank" rel="noopener" loading="lazy">
                <img src="images/x.webp" alt="x">
            </a>
        </div>
</footer>

    <!-- Firebase logic for loading/submitting reviews (unchanged) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        onAuthStateChanged(auth, user => {
            if (user) loadReviews();
            else signInAnonymously(auth);
        });

        const reviewsRef = collection(db, `/artifacts/${appId}/public/data/reviews`);
        const reviewForm = document.getElementById('reviewForm');
        const confirmationMessage = document.getElementById('confirmation-message');
        const reviewsContainer = document.getElementById('reviewsContainer');

        reviewForm.addEventListener('submit', async e => {
            e.preventDefault();
            const name = reviewForm.reviewerName.value;
            const rating = +reviewForm.rating.value;
            const message = reviewForm.reviewMessage.value;
            if (!name || !rating || !message) return alert('Please fill out all fields.');
            await addDoc(reviewsRef, { name, rating, message, createdAt: new Date() });
            reviewForm.reset();
            confirmationMessage.style.opacity = '1';
            setTimeout(() => confirmationMessage.style.opacity = '0', 4000);
        });

        function loadReviews() {
            onSnapshot(query(reviewsRef), snapshot => {
                const reviews = [];
                snapshot.forEach(doc => reviews.push(doc.data()));
                reviews.sort((a, b) => b.createdAt.toDate() - a.createdAt.toDate());
                reviewsContainer.innerHTML = reviews.length
                    ? reviews.map(r => `
                        <div class="review-card p-6">
                          <div class="flex items-center mb-2">
                            <p class="font-bold">${r.name}</p>
                            <div class="ml-auto flex">
                              ${[...Array(5)].map((_,i) =>
                                `<i class="fas fa-star ${i<r.rating?'text-amber-500':'text-gray-300'}"></i>`
                              ).join('')}
                            </div>
                          </div>
                          <p>${r.message}</p>
                        </div>`).join('')
                    : '<p class="text-center text-gray-500">Be the first to leave a review!</p>';
            });
        }
    </script>
</body>
</html>
